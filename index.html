<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Task Manager Application" />
    <link rel="icon" href="favicon.ico" />
    <title>Task Manager</title>
    <link href="css/style.css" rel="stylesheet" />
  </head>
  <body>
    <!-- Mensaje de error -->
    <div class="alert" id="messageContainer"></div>

    <!-- spinner -->
    <div id="spinner-container" class="spinner-hidden">
      <div class="spinner"></div>
    </div>

    <div class="container" id="formLogContainer" style="display: none">
      <div class="form-container" id="loginSection">
        <h2>Ingresar</h2>
        <form id="loginForm">
          <div class="form-group">
            <label class="form-label" for="usernameLogin">Username:</label>
            <input
              type="text"
              id="usernameLogin"
              class="form-input"
              placeholder="Ingrese su nombre de usuario"
              required
              autofocus
            />
          </div>
          <div class="form-group">
            <label for="passwordLogin" class="form-label">Contraseña:</label>
            <input
              type="password"
              id="passwordLogin"
              class="form-input"
              placeholder="Ingresa tu contraseña"
              required
            />
          </div>
          <div class="btn-container">
            <button class="btn btn-primary" id="loginBtn" data-action="login">
              Ingresar
            </button>
          </div>
          <p>
            No tienes una cuenta?
            <a href="#" id="registerLink">Registrate aquí</a>
          </p>
        </form>
      </div>

      <div class="form-container" id="registerSection" style="display: none">
        <h2>Registro</h2>
        <form id="registerForm">
          <div class="form-group">
            <label for="usernameRegister" class="form-label">Username:</label>
            <input
              type="text"
              id="usernameRegister"
              class="form-input"
              placeholder="Ingresa un nombre de usuario"
              required
              autofocus
            />
          </div>
          <div class="form-group">
            <label for="emailRegister" class="form-label">Email:</label>
            <input
              type="email"
              id="emailRegister"
              class="form-input"
              placeholder="Ingrese su email"
              required
              minlength="6"
            />
          </div>
          <div class="form-group">
            <label for="passwordRegister" class="form-label">Contraseña:</label>
            <input
              type="password"
              id="passwordRegister"
              class="form-input"
              placeholder="Ingresa una nueva contraseña"
            />
          </div>
          <div class="btn-container">
            <button class="btn" id="registerBtn" data-action="register">
              Registrarse
            </button>
          </div>
        </form>
        <p>Ya tienes una cuenta? <a href="#" id="loginLink">Ingresa aquí</a></p>
      </div>
    </div>

    <!-- Contenedor principal del layout -->
    <main class="principal-layout">
      <!-- Side bar -->
      <div class="sidebar-container">
        <aside class="sidebar" id="sidebar">
          <ul class="sidebar_list">
            <li
              class="sidebar_element"
              id="sidebarInicioSection"
              data-target="inicioSection"
            >
              <img
                src="assets/dashboard.png"
                alt="Dashboard Icon"
                class="sidebar_icon"
              />
              <div class="sidebar_hide">
                <p class="sidebar_text">Inicio</p>
              </div>
            </li>

            <li
              class="sidebar_element"
              id="sidebarGroupSection"
              data-target="groupSection"
            >
              <img
                src="assets/group.png"
                alt="Group Icon"
                class="sidebar_icon"
              />
              <div class="sidebar_hide">
                <p class="sidebar_text">Grupos</p>
              </div>
            </li>

            <li
              class="sidebar_element"
              id="sidebarProjectSection"
              data-target="projectSection"
            >
              <img src="" alt="Project Icon" class="sidebar_icon" />
              <div class="sidebar_hide">
                <p class="sidebar_text">Proyectos</p>
              </div>
            </li>
            <li
              class="sidebar_element"
              id="sidebarTaskSection"
              data-target="taskSection"
            >
              <img
                src="assets/check-square.png"
                alt="Task Icon"
                class="sidebar_icon"
              />
              <div class="sidebar_hide">
                <p class="sidebar_text">Tareas</p>
              </div>
            </li>
            <li
              class="sidebar_element"
              id="sidebarChatSection"
              data-target="chatSection"
            >
              <img
                src="assets/message-circle.png"
                alt="Chat Icon"
                class="sidebar_icon"
              />
              <div class="sidebar_hide">
                <p class="sidebar_text">Chat</p>
              </div>
            </li>

            <li class="sidebar_element sidebar_element--avatar">
              <img
                src="assets/user.png"
                alt="User Icon"
                class="sidebar_icon sidebar_icon--avatar"
              />
              <div class="sidebar_hide">
                <h3 class="sidebar_title">Mirko</h3>
                <p class="sidebar_info">Cuenta Free</p>
                <button
                  type="button"
                  class="btn btn-error btn-sm btn-block"
                  id="logoutBtn"
                >
                  Cerrar sesión
                </button>
              </div>
            </li>
          </ul>
        </aside>
      </div>

      <!-- Dashboard Layout -->
      <div class="dashboard-layout">
        <!-- Dashboard - Inicio section -->
        <section class="dashboard-section" id="inicioSection">
          <h2>Dashboard</h2>
          <div id="pendingTaskWidget" class="partSections">
            <h3>Tareas pendientes próximas a vencer</h3>
            <ol id="taskDueSoon"></ol>
          </div>
          <div id="projectProgress" class="partSections">
            <h3>Progreso de los proyectos</h3>
            <ol id="projectProgressList"></ol>
          </div>
          <div class="partSections">
            <h3>Notificaciones</h3>
            <ul></ul>
          </div>
        </section>

        <!-- Dashboard - Group section -->
        <section
          class="dashboard-section"
          id="groupSection"
          style="display: none"
        >
          <h2>Mis Grupos</h2>
          <div class="partSections">
            <div class="headerPartSection">
              <h3>Grupos</h3>
              <button type="button" class="btn btn-primary" id="createGroupBtn">
                <span>+ Crear grupo</span>
              </button>
            </div>
            <div id="groupList"></div>
          </div>
        </section>

        <!-- Dashboard - Project section -->
        <section
          class="dashboard-section"
          id="projectSection"
          style="display: none"
        >
          <h2>Proyectos</h2>
          <div class="partSections">
            <h3>Mis Proyectos</h3>
            <ol id="projectList"></ol>
          </div>
        </section>

        <!-- Dashboard - Task section -->
        <section
          class="dashboard-section"
          id="taskSection"
          style="display: none"
        >
          <h2>Tareas</h2>
          <div class="partSections taskPartSection">
            <h3>Proyectos</h3>
          </div>
          <div class="partSections taskPartSection">
            <h3>Tareas</h3>
            <ol id="taskList"></ol>
          </div>
        </section>

        <!-- Dashboard - Chat section -->
        <section
          class="dashboard-section"
          id="chatSection"
          style="display: none"
        >
          <h2>Chat</h2>
          <div class="partSections">
            <h3>Proyectos</h3>
            <ol id="projectListToChat"></ol>
          </div>
          <div class="partSections">
            <h3>Chat</h3>
            <ul id=""></ul>
          </div>
        </section>
      </div>
    </main>

    <!-- Template de grupos -->
    <template id="groupTemplate">
      <div class="card">
        <h4 class="groupName"></h4>
        <p class="numbersOfMembers"></p>
        <div class="template-hide">
          <p class="groupDescription"></p>
          <button
            id="moreDetailsGroup"
            type="button"
            class="btn btn-sm btn-outline-primary btn-manage"
            data-group-id="{{group_id}}"
            data-group-name="{{name}}"
            data-group-description="{{description}}"
          >
            Más detalles
          </button>
        </div>
      </div>
    </template>

    <template id="userGroupTemplate">
      <li>
        <div class="body-template">
          <div class="info-template">
            <p class="userName"></p>
            <p class="userRole"></p>
          </div>
          <div class="actionTemplate">
            <button
              type="button"
              class="btn btn-vsm btn-outline-error manage-btn"
              id="deleteUserGroup"
              data-group-id="{{group_id}}"
              data-user-id="{{user_id}}"
            >
              Eliminar
            </button>
            <button
              type="button"
              class="btn btn-vsm btn-secondary"
              id="editRoleGroup"
              data-group-id="{{group_id}}"
              data-user-id="{{user_id}}"
            >
              Editar
            </button>
          </div>
        </div>
      </li>
    </template>

    <!-- Template de usuarios -->
    <template id="userList">
      <div class="body-template">
        <div class="info-template">
          <p class="userName"></p>
        </div>
        <div class="actionTemplate">
          <button
            type="button"
            class="btn btn-sm"
            id="addUserToGroup"
            data-group-id="{{group_id}}"
            data-user-id="{{user_id}}"
          >
            Agregar
          </button>
        </div>
      </div>
    </template>

    <!-- Modal para forms -->
    <div class="modal-backdrop hidden" id="modalGroup">
      <div class="modal modal-small">
        <header class="modal-header">
          <h4>Crear un nuevo grupo</h4>
        </header>
        <main class="modal-body">
          <form>
            <label for="newGroupName">Nombre del grupo:</label>
            <input type="text" id="newGroupName" />
            <label for="newGroupDescription">Descripción:</label>
            <textarea rows="3" cols="3" id="newGroupDescription"></textarea>
          </form>
        </main>
        <footer class="modal-footer">
          <div class="modal-actions">
            <button
              type="button"
              class="btn btn-outline-error btn-sm"
              id="cancelGroup"
            >
              Cancelar
            </button>
            <button type="button" class="btn btn-primary btn-sm" id="saveGroup">
              Crear
            </button>
          </div>
        </footer>
      </div>
    </div>

    <!-- Modal de lista de usuarios para agregar -->
    <div class="modal-backdrop hidden" id="allUsersList">
      <div class="modal modal-small modal-body">
        <h3>Usuarios</h3>
        <ol class="allUsersList"></ol>
      </div>
    </div>

    <!-- Modal genérico-->
    <div class="modal-backdrop hidden" id="genericModal">
      <div class="modal">
        <header class="modal-header"></header>
        <main class="modal-body"></main>
        <footer class="modal-footer">
          <div class="modal-actions"></div>
        </footer>
      </div>
    </div>

    <!-- Scripts -->
    <script type="module" rel="preload" src="js/auth.js" defer></script>
    <script type="module" src="js/dom.js" defer></script>
    <script type="module" src="js/dashboard.js" defer></script>
    <script type="module" src="js/api.js" defer></script>
    <script type="module" src="js/utils/utils.js"></script>
    <script type="module" src="js/utils/modal.js"></script>
  </body>
</html>
